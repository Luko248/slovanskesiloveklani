---
phase: 01-foundation-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/utils/eventConfig.ts
  - src/utils/calendar.ts
autonomous: true

must_haves:
  truths:
    - "Event data is defined in single source of truth"
    - "Calendar download uses correct event times (9:30-16:00 CEST)"
    - "Calendar filename shows 2026 year"
  artifacts:
    - path: "src/utils/eventConfig.ts"
      provides: "Single source of truth for event data"
      exports: ["EVENT_CONFIG"]
    - path: "src/utils/calendar.ts"
      provides: "Calendar generation and download"
      contains: "import { EVENT_CONFIG }"
  key_links:
    - from: "src/utils/calendar.ts"
      to: "src/utils/eventConfig.ts"
      via: "import statement"
      pattern: "import.*EVENT_CONFIG.*from.*eventConfig"
---

<objective>
Create centralized event configuration and fix calendar export

Purpose: Establish single source of truth for all event data (date, time, location) that will be imported by all components, and fix the calendar download to use correct times and filename.

Output: eventConfig.ts with EVENT_CONFIG constant, updated calendar.ts importing from eventConfig
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-fixes/01-RESEARCH.md
@src/utils/calendar.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create eventConfig.ts with EVENT_CONFIG constant</name>
  <files>src/utils/eventConfig.ts</files>
  <action>
Create new file `src/utils/eventConfig.ts` with:

1. Define EVENT_CONFIG object with all event details:
   - title: "Slovanské Silové Klání 2026"
   - edition: "5. ročník"
   - date: { year: 2026, month: 6, day: 13 }
   - time: { startHour: 9, startMinute: 30, endHour: 16, endMinute: 0 }
   - timezone: "Europe/Prague"
   - location: { name: "Za Hasičskou Zbrojnicí", city: "Pustiměř", country: "Česká republika" }

2. Export helper functions:
   - getFormattedDate(locale?: string): string - returns "13.06.2026" format
   - getFormattedTime(): string - returns "9:30 - 16:00"
   - getFormattedDateTime(): string - returns "13.06.2026 | 9:30"
   - getICSStartTime(): string - returns UTC format "20260613T073000Z" (9:30 CEST = 7:30 UTC)
   - getICSEndTime(): string - returns UTC format "20260613T140000Z" (16:00 CEST = 14:00 UTC)
   - getFullLocation(): string - returns "Za Hasičskou Zbrojnicí, Pustiměř"

3. Use TypeScript with proper typing for the config object

Why these times: June is CEST (UTC+2), so 9:30 CEST = 07:30 UTC and 16:00 CEST = 14:00 UTC
  </action>
  <verify>
- File exists at src/utils/eventConfig.ts
- TypeScript compiles without errors: `bunx tsc --noEmit src/utils/eventConfig.ts`
- Exports EVENT_CONFIG and helper functions
  </verify>
  <done>
eventConfig.ts created with EVENT_CONFIG constant and helper functions for date/time formatting
  </done>
</task>

<task type="auto">
  <name>Task 2: Update calendar.ts to use eventConfig</name>
  <files>src/utils/calendar.ts</files>
  <action>
Modify `src/utils/calendar.ts`:

1. Add import at top: `import { EVENT_CONFIG, getICSStartTime, getICSEndTime, getFullLocation } from './eventConfig';`

2. Update generateICS function:
   - Replace hardcoded title with EVENT_CONFIG.title
   - Replace hardcoded startTime "20260613T080000Z" with getICSStartTime() result
   - Replace hardcoded endTime "20260613T160000Z" with getICSEndTime() result
   - Replace hardcoded location with getFullLocation()
   - Keep description as is (bilingual text is fine)

3. Update downloadICS function:
   - Change filename from 'slovanske-silove-klani-2025.ics' to 'slovanske-silove-klani-2026.ics'
   - Alternatively, derive from EVENT_CONFIG.date.year: `slovanske-silove-klani-${EVENT_CONFIG.date.year}.ics`

4. Remove any hardcoded date/time values - all should come from eventConfig

Note: Current file has wrong UTC times (08:00 and 16:00 UTC which would be 10:00 and 18:00 CEST). Correct values are 07:30 and 14:00 UTC for 9:30 and 16:00 CEST.
  </action>
  <verify>
- No hardcoded date/time values in calendar.ts (grep for "2026" should only find import or dynamic generation)
- Import statement present for eventConfig
- Build succeeds: `bun run build`
- Manual test: Open site, click "Do Kalendáře" button, verify downloaded .ics file:
  - Filename is "slovanske-silove-klani-2026.ics"
  - DTSTART shows 20260613T073000Z
  - DTEND shows 20260613T140000Z
  </verify>
  <done>
calendar.ts imports from eventConfig, uses correct times (9:30-16:00 CEST), downloads with 2026 in filename
  </done>
</task>

</tasks>

<verification>
- [ ] eventConfig.ts exists with EVENT_CONFIG export
- [ ] calendar.ts imports from eventConfig
- [ ] `bun run build` succeeds
- [ ] Calendar download produces file named "slovanske-silove-klani-2026.ics"
- [ ] ICS file contains correct UTC times (07:30-14:00 UTC = 9:30-16:00 CEST)
</verification>

<success_criteria>
- Single source of truth established in eventConfig.ts
- Calendar uses centralized event data
- Calendar filename shows 2026
- Calendar times are correct (9:30-16:00 CEST)
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-fixes/01-01-SUMMARY.md`
</output>
