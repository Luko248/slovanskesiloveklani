---
import '../styles/global.css';
import { EVENT_CONFIG } from '../utils/eventConfig';

interface Props {
  title: string;
  description?: string;
  lang?: string;
}

const {
  title,
  description = "Slovanské Silové Klání 2026 v Pustiměři: amatérská silová soutěž, originální disciplíny, doprovodný program, lukostřelba, kovářská dílna a grilování.",
  lang = "cs",
} = Astro.props;

const siteUrl = "https://slovanskesiloveklani.cz";
const ogImage = `${siteUrl}/images/meta.jpg`;
const seoTitle = title.trim();
const seoDescription = description.trim();
const faviconVersion = "20260214";
const faviconIco = `/favicons/favicon.ico?v=${faviconVersion}`;
const faviconSvg = `/favicons/favicon.svg?v=${faviconVersion}`;
const faviconPng96 = `/favicons/favicon-96x96.png?v=${faviconVersion}`;
const appleTouchIcon = `/favicons/apple-touch-icon.png?v=${faviconVersion}`;
const webManifest = `/manifest.json?v=${faviconVersion}`;

const { date, time, location } = EVENT_CONFIG;
const startDate = `${date.year}-${String(date.month).padStart(2, '0')}-${String(date.day).padStart(2, '0')}T${String(time.startHour).padStart(2, '0')}:${String(time.startMinute).padStart(2, '0')}:00+02:00`;
const endDate = `${date.year}-${String(date.month).padStart(2, '0')}-${String(date.day).padStart(2, '0')}T${String(time.endHour).padStart(2, '0')}:${String(time.endMinute).padStart(2, '0')}:00+02:00`;

const eventSchema = {
  "@context": "https://schema.org",
  "@type": "SportsEvent",
  "name": EVENT_CONFIG.title,
  "description": seoDescription,
  "startDate": startDate,
  "endDate": endDate,
  "eventStatus": "https://schema.org/EventScheduled",
  "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
  "location": {
    "@type": "Place",
    "name": `${location.name}, ${location.city}`,
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Pustiměřské Prusy",
      "addressLocality": location.city,
      "addressCountry": "CZ"
    },
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 49.317780,
      "longitude": 17.028537
    }
  },
  "image": ogImage,
  "url": siteUrl,
  "organizer": {
    "@type": "Person",
    "name": "Marek Vidlář",
    "email": "SlovanskeSiloveKlani@gmail.com"
  },
  "performer": {
    "@type": "Organization",
    "name": "Slovanské Silové Klání"
  },
  "offers": {
    "@type": "Offer",
    "url": "https://docs.google.com/forms/d/e/1FAIpQLSeozQgEQ6qN_sNz90AcjWIDdD4wrCdym3E20iCs4QO00IDrtg/viewform",
    "availability": "https://schema.org/InStock",
    "validFrom": "2025-01-01"
  },
  "sport": "Silová soutěž",
  "inLanguage": "cs"
};

const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Slovanské Silové Klání",
  "url": siteUrl,
  "inLanguage": "cs"
};

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Domů",
      "item": siteUrl
    }
  ]
};
---

<!doctype html>
<html lang={lang} class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{seoTitle}</title>
    <meta name="description" content={seoDescription} />
    <meta name="keywords" content="silová soutěž, silová soutěž Morava, silový sport Česko, amatérská soutěž, amatérská silová soutěž, Pustiměř, slovanské klání, Slovanské Silové Klání, silové klání 2026, silový sport, silák soutěž, zvedání kamenů, klád, železa, Morava, Vyškov" />

    <!-- Canonical & Alternate -->
    <link rel="canonical" href={siteUrl} />
    <link rel="alternate" hreflang="cs" href={siteUrl} />

    <!-- Favicon -->
    <link rel="icon" href={faviconIco} sizes="any" />
    <link rel="icon" type="image/png" href={faviconPng96} sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href={faviconSvg} />
    <link rel="shortcut icon" href={faviconIco} />
    <link rel="apple-touch-icon" sizes="180x180" href={appleTouchIcon} />
    <meta name="apple-mobile-web-app-title" content="SlovanskeSiloveKlani" />
    <link rel="manifest" href={webManifest} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={seoTitle} />
    <meta property="og:description" content={seoDescription} />
    <meta property="og:url" content={siteUrl} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Slovanské Silové Klání — amatérská silová soutěž" />
    <meta property="og:locale" content="cs_CZ" />
    <meta property="og:site_name" content="Slovanské Silové Klání" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={seoTitle} />
    <meta name="twitter:description" content={seoDescription} />
    <meta name="twitter:image" content={ogImage} />
    <meta name="twitter:image:alt" content="Slovanské Silové Klání — amatérská silová soutěž" />

    <!-- SEO -->
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="author" content="Marek Vidlář" />
    <meta name="generator" content={Astro.generator} />

    <!-- Mobile / PWA -->
    <meta name="theme-color" content="#000" />
    <meta name="color-scheme" content="dark" />
    <meta name="format-detection" content="telephone=no" />

    <!-- Geo -->
    <meta name="geo.region" content="CZ-64" />
    <meta name="geo.placename" content="Pustiměř" />
    <meta name="geo.position" content="49.317780;17.028537" />
    <meta name="ICBM" content="49.317780, 17.028537" />

    <!-- Google Tag Manager -->
    <script is:inline>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TFXJMMGS');</script>
    <!-- End Google Tag Manager -->

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=MedievalSharp&display=swap" rel="stylesheet" />

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify(eventSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  </head>
  <body class="min-h-screen flex flex-col relative overflow-x-hidden bg-slavic-pattern">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TFXJMMGS" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <slot />
  </body>
</html>
